<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FutureCast Library | Curated Collection</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,600;0,700;1,400&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-body: #F5F5F2;
            --bg-card: #FFFFFF;
            --text-primary: #111111;
            --text-secondary: #555555;
            --text-tertiary: #888888;
            --accent-color: #8C2F39;
            --border-color: #E0E0E0;
            --shadow-card: 0 1px 3px rgba(0,0,0,0.05), 0 1px 2px rgba(0,0,0,0.1);
            --shadow-hover: 0 10px 15px -3px rgba(0,0,0,0.08), 0 4px 6px -2px rgba(0,0,0,0.04);
            --font-serif: 'EB Garamond', serif;
            --font-sans: 'Inter', sans-serif;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
        
        body {
            background-color: var(--bg-body);
            color: var(--text-primary);
            font-family: var(--font-sans);
            line-height: 1.5;
            font-size: 14px;
        }

        button { font-family: inherit; border: none; background: none; cursor: pointer; }

        /* --- Header --- */
        header {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2.5rem 2rem 1.5rem;
            text-align: center;
        }

        h1 {
            font-family: var(--font-serif);
            font-size: 2.5rem;
            font-weight: 500;
            letter-spacing: -0.02em;
        }

        .subtitle {
            font-family: var(--font-serif);
            font-style: italic;
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin-top: 0.25rem;
        }

        /* --- Progress --- */
        .progress-container {
            max-width: 300px;
            margin: 1rem auto 0;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .progress-text {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        .progress-bar-bg {
            flex: 1;
            height: 4px;
            background: #E5E5E5;
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: var(--text-primary);
            width: 0;
            transition: width 0.5s ease;
        }

        /* --- Controls --- */
        .controls-wrapper {
            position: sticky;
            top: 0;
            z-index: 100;
            background: rgba(245, 245, 242, 0.95);
            backdrop-filter: blur(8px);
            border-bottom: 1px solid var(--border-color);
            padding: 0.75rem 0;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.02);
        }

        .controls-inner {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            gap: 1rem;
            align-items: center;
        }

        .search-box {
            position: relative;
            flex: 1;
            max-width: 400px;
        }

        .search-input {
            width: 100%;
            padding: 0.5rem 0.75rem 0.5rem 2.25rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 0.85rem;
            background: var(--bg-card);
            font-family: var(--font-sans);
        }

        .search-input:focus {
            border-color: var(--text-primary);
            box-shadow: 0 0 0 1px var(--text-primary);
        }

        .search-icon {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.85rem;
            color: var(--text-tertiary);
            pointer-events: none;
        }

        .filters {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        select {
            padding: 0.5rem 2rem 0.5rem 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 0.8rem;
            background-color: var(--bg-card);
            cursor: pointer;
            font-family: var(--font-sans);
            color: var(--text-primary);
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' viewBox='0 0 24 24' fill='none' stroke='%23333' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.5rem center;
        }

        .export-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-card);
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.2s;
            margin-right: 0.5rem;
        }

        .export-btn:hover {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
            transform: translateY(-1px);
        }

        .view-toggle {
            display: flex;
            background: #E5E5E5;
            padding: 2px;
            border-radius: 6px;
            margin-left: 0.5rem;
        }

        .view-btn {
            padding: 4px 10px;
            font-size: 0.75rem;
            border-radius: 4px;
            color: var(--text-secondary);
            font-weight: 500;
            transition: all 0.2s;
        }

        .view-btn.active {
            background: #fff;
            color: #000;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        /* --- Main & Utility --- */
        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem 4rem;
            min-height: 60vh;
        }

        .hidden { display: none !important; }

        /* --- Grid View --- */
        .grid-view {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 1rem;
        }

        .book-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.25rem 1rem;
            position: relative;
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            min-height: 180px;
            box-shadow: var(--shadow-card);
            overflow: hidden;
            cursor: pointer; /* Indicates Clickable */
        }

        .book-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
            border-color: #ccc;
        }

        .card-rank {
            position: absolute;
            top: -0.5rem;
            right: 0.25rem;
            font-family: var(--font-serif);
            font-size: 3.5rem;
            color: #000;
            opacity: 0.04;
            font-weight: 700;
            line-height: 1;
            pointer-events: none;
            z-index: 0;
        }

        .card-content {
            z-index: 1;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .title-en {
            font-family: var(--font-serif);
            font-size: 1.25rem;
            font-weight: 600;
            line-height: 1.2;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .title-cn {
            font-family: var(--font-sans);
            font-size: 0.8rem;
            color: var(--text-tertiary);
            margin-bottom: 0.75rem;
            line-height: 1.3;
        }

        .author {
            font-family: var(--font-sans);
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
            font-weight: 600;
            margin-top: auto;
            padding-top: 0.75rem;
            border-top: 1px solid #F0F0F0;
        }

        .card-actions {
            margin-top: 0.75rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 2;
        }

        .status-label {
            font-size: 0.7rem;
            color: var(--text-tertiary);
            font-weight: 500;
        }

        /* --- List View (Table) --- */
        .table-view {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            font-size: 0.9rem;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            text-align: left;
            padding: 0.75rem 1.5rem;
            font-size: 0.75rem;
            text-transform: uppercase;
            color: var(--text-tertiary);
            font-weight: 600;
            border-bottom: 1px solid var(--border-color);
            background: #FAFAFA;
            cursor: pointer;
        }
        
        th:hover { color: var(--text-primary); }

        td {
            padding: 0.6rem 1.5rem;
            border-bottom: 1px solid #F0F0F0;
            vertical-align: middle;
        }

        tr { cursor: pointer; }
        tr:last-child td { border-bottom: none; }
        tr:hover { background-color: #FAFAF8; }

        .table-rank {
            font-family: var(--font-serif);
            font-weight: 600;
            color: var(--text-tertiary);
            width: 60px;
        }

        .table-title {
            font-family: var(--font-serif);
            font-size: 1.05rem;
            font-weight: 500;
            color: var(--text-primary);
        }
        
        .table-meta {
            font-size: 0.8rem;
            color: var(--text-tertiary);
        }

        /* Shared Check Button */
        .check-btn {
            width: 24px;
            height: 24px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            background: transparent;
            transition: all 0.2s;
            position: relative;
            z-index: 10; /* Ensure button sits above card link */
        }

        .check-btn:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
            background: rgba(140, 47, 57, 0.05);
        }

        .check-btn svg {
            width: 14px;
            height: 14px;
            stroke-width: 2.5;
            opacity: 0;
            transition: opacity 0.2s;
        }

        /* Read State Styling */
        .is-read { background-color: #FAFAF8; }
        .grid-view .book-card.is-read { background-color: #FAFAF8; }

        .is-read .title-en, 
        .is-read .table-title {
            text-decoration: line-through;
            text-decoration-color: var(--accent-color);
            opacity: 0.6;
        }

        .is-read .check-btn {
            background: var(--accent-color);
            border-color: var(--accent-color);
        }
        
        .is-read .check-btn:hover {
            opacity: 0.9;
        }

        .is-read .check-btn svg {
            opacity: 1;
            stroke: #fff;
        }
        
        .is-read .status-label { color: var(--accent-color); }

        /* --- Note Badge (Red Dot) --- */
        .note-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 10px;
            height: 10px;
            background-color: #FF4444;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(255, 68, 68, 0.4);
            z-index: 5;
        }

        .table-note-badge {
            display: inline-block;
            width: 8px;
            height: 8px;
            background-color: #FF4444;
            border-radius: 50%;
            margin-left: 0.5rem;
            box-shadow: 0 1px 2px rgba(255, 68, 68, 0.3);
            vertical-align: middle;
        }

        /* --- Pagination --- */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.25rem;
            margin-top: 2rem;
            padding-bottom: 1rem;
        }

        .page-btn {
            min-width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            font-size: 0.8rem;
            color: var(--text-secondary);
            border: 1px solid transparent;
        }

        .page-btn:hover:not(:disabled) {
            background: #fff;
            border-color: var(--border-color);
            color: #000;
        }

        .page-btn.active {
            background: var(--text-primary);
            color: #fff;
        }

        .page-btn:disabled { opacity: 0.3; }

        /* --- Responsive --- */
        @media (max-width: 768px) {
            .controls-inner { flex-direction: column; padding: 0 1rem; align-items: stretch; }
            .search-box { max-width: none; }
            .filters { justify-content: space-between; }
            
            /* Grid Mobile */
            .grid-view { grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 0.75rem; }
            .book-card { min-height: 160px; padding: 1rem 0.75rem; }
            .title-en { font-size: 1.1rem; }
            .card-rank { font-size: 2.5rem; }
            
            /* List View Mobile Fixes */
            thead { display: none; } 
            
            .table-view tr { 
                display: block; 
                padding: 1rem; 
                border-bottom: 1px solid var(--border-color); 
                position: relative;
            }
            
            .table-view td { 
                display: block; 
                padding: 0.15rem 0; 
                border: none; 
            }

            .table-rank { 
                font-size: 0.9rem; 
                color: var(--accent-color);
                opacity: 0.8;
                margin-bottom: 0.25rem;
            }

            .table-check-cell { 
                position: absolute; 
                right: 1rem; 
                top: 50%; 
                transform: translateY(-50%);
                padding: 0 !important;
                width: auto;
            }
        }
    </style>
</head>
<body>

    <header>
        <h1>FutureCast Library</h1>
        <div class="subtitle">100 Books to shape your worldview.</div>
        
        <div class="progress-container">
            <div class="progress-text" id="progress-text">0 / 100</div>
            <div class="progress-bar-bg">
                <div class="progress-bar-fill" id="progress-fill"></div>
            </div>
        </div>
    </header>

    <div class="controls-wrapper">
        <div class="controls-inner">
            <div class="search-box">
                <span class="search-icon">üîç</span>
                <input type="text" class="search-input" id="searchInput" placeholder="Search by title or author...">
            </div>
            
            <div class="filters">
                <select id="filterSelect">
                    <option value="all">All Books</option>
                    <option value="read">Read</option>
                    <option value="unread">Unread</option>
                </select>

                <a href="export-data.html" class="export-btn" title="ÂØºÂá∫Êï∞ÊçÆ">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                </a>

                <div class="view-toggle">
                    <button class="view-btn active" data-view="grid">Grid</button>
                    <button class="view-btn" data-view="list">List</button>
                </div>
            </div>
        </div>
    </div>

    <main>
        <div id="gridView" class="grid-view"></div>
        <div id="listView" class="table-view hidden">
            <table class="data-table">
                <thead>
                    <tr>
                        <th data-sort="rank" style="width: 80px;">Rank</th>
                        <th data-sort="title">Book Details</th>
                        <th data-sort="author">Author</th>
                        <th style="text-align: right; width: 60px;">Status</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
        
        <div id="pagination" class="pagination"></div>

        <div id="emptyState" class="hidden" style="text-align:center; padding: 3rem; color: #999;">
            No books found.
        </div>
    </main>

    <script>
        const books = [
            { rank: 1, en: "Sapiens", cn: "‰∫∫Á±ªÁÆÄÂè≤", author: "Yuval Noah Harari" },
            { rank: 2, en: "Man's Search for Meaning", cn: "Ê¥ªÂá∫ÊÑè‰πâÊù•", author: "Viktor E. Frankl" },
            { rank: 3, en: "Principles", cn: "ÂéüÂàô", author: "Ray Dalio" },
            { rank: 4, en: "Zero to One", cn: "‰ªé0Âà∞1", author: "Peter Thiel" },
            { rank: 5, en: "Thinking, Fast and Slow", cn: "ÊÄùËÄÉÔºåÂø´‰∏éÊÖ¢", author: "Daniel Kahneman" },
            { rank: 6, en: "Influence", cn: "ÂΩ±ÂìçÂäõ", author: "Robert B. Cialdini" },
            { rank: 7, en: "The 4-Hour Workweek", cn: "ÊØèÂë®Â∑•‰Ωú4Â∞èÊó∂", author: "Tim Ferriss" },
            { rank: 8, en: "The Hard Thing About Hard Things", cn: "Âàõ‰∏öÁª¥Ëâ∞", author: "Ben Horowitz" },
            { rank: 9, en: "Shoe Dog", cn: "ÈûãÁãó", author: "Phil Knight" },
            { rank: 10, en: "Atlas Shrugged", cn: "ÈòøÁâπÊãâÊñØËÄ∏ËÄ∏ËÇ©", author: "Ayn Rand" },
            { rank: 11, en: "The Innovator's Dilemma", cn: "ÂàõÊñ∞ËÄÖÁöÑÁ™òÂ¢É", author: "Clayton M. Christensen" },
            { rank: 12, en: "Atomic Habits", cn: "ÂéüÂ≠ê‰π†ÊÉØ", author: "James Clear" },
            { rank: 13, en: "The Alchemist", cn: "ÁâßÁæäÂ∞ëÂπ¥Â•áÂπª‰πãÊóÖ", author: "Paulo Coelho" },
            { rank: 14, en: "Meditations", cn: "Ê≤âÊÄùÂΩï", author: "Marcus Aurelius" },
            { rank: 15, en: "The War of Art", cn: "Ëâ∫ÊúØÊàò‰∫â", author: "Steven Pressfield" },
            { rank: 16, en: "High Output Management", cn: "Ê†ºÈ≤ÅÂ§´ÁªôÁªèÁêÜ‰∫∫ÁöÑÁ¨¨‰∏ÄËØæ", author: "Andrew Grove" },
            { rank: 17, en: "Antifragile", cn: "ÂèçËÑÜÂº±", author: "Nassim Nicholas Taleb" },
            { rank: 18, en: "Steve Jobs", cn: "Âè≤ËíÇÂ§´¬∑‰πîÂ∏ÉÊñØ‰º†", author: "Walter Isaacson" },
            { rank: 19, en: "How To Win Friends and Influence People", cn: "‰∫∫ÊÄßÁöÑÂº±ÁÇπ", author: "Dale Carnegie" },
            { rank: 20, en: "Dune", cn: "Ê≤ô‰∏ò", author: "Frank Herbert" },
            { rank: 21, en: "Good to Great", cn: "‰ªé‰ºòÁßÄÂà∞ÂçìË∂ä", author: "Jim Collins" },
            { rank: 22, en: "Mindset", cn: "ÁªàË∫´ÊàêÈïø", author: "Carol S. Dweck" },
            { rank: 23, en: "Harry Potter", cn: "ÂìàÂà©¬∑Ê≥¢Áâπ", author: "J.K. Rowling" },
            { rank: 24, en: "The Black Swan", cn: "ÈªëÂ§©ÈπÖ", author: "Nassim Nicholas Taleb" },
            { rank: 25, en: "Surely You're Joking, Mr. Feynman!", cn: "Âà´Èóπ‰∫ÜÔºåË¥πÊõºÂÖàÁîü", author: "Richard P. Feynman" },
            { rank: 26, en: "1984", cn: "1984", author: "George Orwell" },
            { rank: 27, en: "Outliers", cn: "ÂºÇÁ±ª", author: "Malcolm Gladwell" },
            { rank: 28, en: "The Lean Startup", cn: "Á≤æÁõäÂàõ‰∏ö", author: "Eric Ries" },
            { rank: 29, en: "Poor Charlie's Almanack", cn: "Á©∑Êü•ÁêÜÂÆùÂÖ∏", author: "Charlie Munger" },
            { rank: 30, en: "Snow Crash", cn: "Èõ™Â¥©", author: "Neal Stephenson" },
            { rank: 31, en: "Range", cn: "Ë∑®ËÉΩËá¥Âãù (ÈÄöÊâç)", author: "David Epstein" },
            { rank: 32, en: "The Four Agreements", cn: "ÈÄöÂæÄÂøÉÁÅµËá™Áî±ÁöÑÂõõ‰∏™Á∫¶ÂÆö", author: "Don Miguel Ruiz" },
            { rank: 33, en: "Elon Musk", cn: "Á°ÖË∞∑Èí¢ÈìÅ‰æ†", author: "Ashlee Vance" },
            { rank: 34, en: "Siddhartha", cn: "ÊÇâËææÂ§ö", author: "Hermann Hesse" },
            { rank: 35, en: "Skin in the Game", cn: "ÈùûÂØπÁß∞È£éÈô©", author: "Nassim Nicholas Taleb" },
            { rank: 36, en: "Tools of Titans", cn: "Â∑®‰∫∫ÁöÑÂ∑•ÂÖ∑", author: "Tim Ferriss" },
            { rank: 37, en: "The Selfish Gene", cn: "Ëá™ÁßÅÁöÑÂü∫Âõ†", author: "Richard Dawkins" },
            { rank: 38, en: "The Intelligent Investor", cn: "ËÅ™ÊòéÁöÑÊäïËµÑËÄÖ", author: "Benjamin Graham" },
            { rank: 39, en: "Essentialism", cn: "Á≤æË¶Å‰∏ª‰πâ", author: "Greg McKeown" },
            { rank: 40, en: "The Lord of the Rings", cn: "ÊåáÁéØÁéã", author: "J.R.R. Tolkien" },
            { rank: 41, en: "The Ride of a Lifetime", cn: "‰∏ÄÁîüÁöÑÊóÖÁ®ã", author: "Robert Iger" },
            { rank: 42, en: "The Lessons of History", cn: "ÂéÜÂè≤ÁöÑÊïôËÆ≠", author: "Will & Ariel Durant" },
            { rank: 43, en: "Loonshots", cn: "Áõ∏Âèò", author: "Safi Bahcall" },
            { rank: 44, en: "The Fountainhead", cn: "Ê∫êÊ≥â", author: "Ayn Rand" },
            { rank: 45, en: "The Three-Body Problem", cn: "‰∏â‰Ωì", author: "Cixin Liu" },
            { rank: 46, en: "How to Change Your Mind", cn: "ÊîπËÆä‰Ω†ÁöÑÂøÉÊô∫", author: "Michael Pollan" },
            { rank: 47, en: "Tao Te Ching", cn: "ÈÅìÂæ∑Áªè", author: "Lao Tzu" },
            { rank: 48, en: "12 Rules for Life", cn: "‰∫∫ÁîüÂçÅ‰∫åÊ≥ïÂàô", author: "Jordan Peterson" },
            { rank: 49, en: "Crime and Punishment", cn: "ÁΩ™‰∏éÁΩö", author: "Fyodor Dostoyevsky" },
            { rank: 50, en: "When Breath Becomes Air", cn: "ÂΩìÂëºÂê∏Âåñ‰∏∫Á©∫Ê∞î", author: "Paul Kalanithi" },
            { rank: 51, en: "The Great Gatsby", cn: "‰∫Ü‰∏çËµ∑ÁöÑÁõñËå®ÊØî", author: "F. Scott Fitzgerald" },
            { rank: 52, en: "Guns, Germs, and Steel", cn: "Êû™ÁÇÆ„ÄÅÁóÖËèå‰∏éÈí¢ÈìÅ", author: "Jared Diamond" },
            { rank: 53, en: "The Power of Habit", cn: "‰π†ÊÉØÁöÑÂäõÈáè", author: "Charles Duhigg" },
            { rank: 54, en: "The Catcher in the Rye", cn: "È∫¶Áî∞ÈáåÁöÑÂÆàÊúõËÄÖ", author: "J.D. Salinger" },
            { rank: 55, en: "The Design of Everyday Things", cn: "ËÆæËÆ°ÂøÉÁêÜÂ≠¶", author: "Don Norman" },
            { rank: 56, en: "Creativity, Inc.", cn: "ÂàõÊñ∞ÂÖ¨Âè∏", author: "Ed Catmull" },
            { rank: 57, en: "The 7 Habits of Highly Effective People", cn: "È´òÊïàËÉΩ‰∫∫Â£´ÁöÑ‰∏É‰∏™‰π†ÊÉØ", author: "Stephen R. Covey" },
            { rank: 58, en: "Deep Work", cn: "Ê∑±Â∫¶Â∑•‰Ωú", author: "Cal Newport" },
            { rank: 59, en: "The Art of War", cn: "Â≠ôÂ≠êÂÖµÊ≥ï", author: "Sun Tzu" },
            { rank: 60, en: "Fooled by Randomness", cn: "ÈöèÊú∫Êº´Ê≠•ÁöÑÂÇªÁìú", author: "Nassim Nicholas Taleb" },
            { rank: 61, en: "The Checklist Manifesto", cn: "Ê∏ÖÂçïÈù©ÂëΩ", author: "Atul Gawande" },
            { rank: 62, en: "The Courage to Be Disliked", cn: "Ë¢´ËÆ®ÂéåÁöÑÂãáÊ∞î", author: "Ichiro Kishimi" },
            { rank: 63, en: "Brave New World", cn: "Áæé‰∏ΩÊñ∞‰∏ñÁïå", author: "Aldous Huxley" },
            { rank: 64, en: "Homo Deus", cn: "Êú™Êù•ÁÆÄÂè≤", author: "Yuval Noah Harari" },
            { rank: 65, en: "Zen and the Art of Motorcycle Maintenance", cn: "Á¶Ö‰∏éÊë©ÊâòËΩ¶Áª¥‰øÆËâ∫ÊúØ", author: "Robert M. Pirsig" },
            { rank: 66, en: "The Score Takes Care of Itself", cn: "Á°¨Ê¥æÈ¢ÜÂØºÂì≤Â≠¶", author: "Bill Walsh" },
            { rank: 67, en: "Crossing the Chasm", cn: "Ë∑®Ë∂äÈ∏øÊ≤ü", author: "Geoffrey A. Moore" },
            { rank: 68, en: "Extreme Ownership", cn: "ÊûÅÁ´ØÊâÄÊúâÊùÉ", author: "Jocko Willink" },
            { rank: 69, en: "High Growth Handbook", cn: "È´òÊàêÈïøÊâãÂÜå", author: "Elad Gil" },
            { rank: 70, en: "Project Hail Mary", cn: "ÊåΩÊïëËÆ°Âàí", author: "Andy Weir" },
            { rank: 71, en: "Made to Stick", cn: "Á≤ò‰Ωè", author: "Chip & Dan Heath" },
            { rank: 72, en: "The Effective Executive", cn: "ÂçìÊúâÊàêÊïàÁöÑÁÆ°ÁêÜËÄÖ", author: "Peter F. Drucker" },
            { rank: 73, en: "The Undoing Project", cn: "Ê©°ÁöÆÊì¶ËÆ°Âàí", author: "Michael Lewis" },
            { rank: 74, en: "Why We Sleep", cn: "‰∏∫‰ªÄ‰πàË¶ÅÁù°Ëßâ", author: "Matthew Walker" },
            { rank: 75, en: "Anna Karenina", cn: "ÂÆâÂ®ú¬∑Âç°ÂàóÂ∞ºÂ®ú", author: "Leo Tolstoy" },
            { rank: 76, en: "Benjamin Franklin", cn: "ÂØåÂÖ∞ÂÖãÊûó‰º†", author: "Walter Isaacson" },
            { rank: 77, en: "Animal Farm", cn: "Âä®Áâ©Â∫ÑÂõ≠", author: "George Orwell" },
            { rank: 78, en: "The Almanack of Naval Ravikant", cn: "Á∫≥Áì¶Â∞îÂÆùÂÖ∏", author: "Eric Jorgenson" },
            { rank: 79, en: "The Psychology of Money", cn: "ÈáëÈí±ÂøÉÁêÜÂ≠¶", author: "Morgan Housel" },
            { rank: 80, en: "Measure What Matters", cn: "Ë°°Èáè‰ªÄ‰πàÈáçË¶Å", author: "John Doerr" },
            { rank: 81, en: "Think and Grow Rich", cn: "ÊÄùËÄÉËá¥ÂØå", author: "Napoleon Hill" },
            { rank: 82, en: "Only the Paranoid Survive", cn: "Âè™ÊúâÂÅèÊâßÁãÇÊâçËÉΩÁîüÂ≠ò", author: "Andrew Grove" },
            { rank: 83, en: "Can't Hurt Me", cn: "ÊàëÔºåÂàÄÊû™‰∏çÂÖ•", author: "David Goggins" },
            { rank: 84, en: "Foundation", cn: "Âü∫Âú∞", author: "Isaac Asimov" },
            { rank: 85, en: "Blitzscaling", cn: "Èó™ÁîµÂºèÊâ©Âº†", author: "Reid Hoffman" },
            { rank: 86, en: "Seeking Wisdom", cn: "Êé¢Á¥¢Êô∫ÊÖß", author: "Peter Bevelin" },
            { rank: 87, en: "Digital Minimalism", cn: "Êï∞Â≠óÊûÅÁÆÄ‰∏ª‰πâ", author: "Cal Newport" },
            { rank: 88, en: "How Not to Die", cn: "ÊïëÂëΩ", author: "Dr. Michael Greger" },
            { rank: 89, en: "The Art of Possibility", cn: "ÂèØËÉΩÊÄßËâ∫ÊúØ", author: "Rosamund Stone Zander" },
            { rank: 90, en: "The Righteous Mind", cn: "Ê≠£‰πâ‰πãÂøÉ", author: "Jonathan Haidt" },
            { rank: 91, en: "The Book of Five Rings", cn: "‰∫îËΩÆ‰π¶", author: "Miyamoto Musashi" },
            { rank: 92, en: "The Code Breaker", cn: "Á†¥Ëß£ËÄÖ", author: "Walter Isaacson" },
            { rank: 93, en: "The Emperor of All Maladies", cn: "‰∏áÁóÖ‰πãÁéã", author: "Siddhartha Mukherjee" },
            { rank: 94, en: "The Gene", cn: "Âü∫Âõ†", author: "Siddhartha Mukherjee" },
            { rank: 95, en: "The Innovators", cn: "ÂàõÊñ∞ËÄÖ", author: "Walter Isaacson" },
            { rank: 96, en: "The Everything Store", cn: "‰∏ÄÁΩëÊâìÂ∞Ω", author: "Brad Stone" },
            { rank: 97, en: "The Wright Brothers", cn: "Ëé±ÁâπÂÖÑÂºü", author: "David McCullough" },
            { rank: 98, en: "The Making of the Atomic Bomb", cn: "ÂéüÂ≠êÂºπÁßòÂè≤", author: "Richard Rhodes" },
            { rank: 99, en: "The Structure of Scientific Revolutions", cn: "ÁßëÂ≠¶Èù©ÂëΩÁöÑÁªìÊûÑ", author: "Thomas S. Kuhn" },
            { rank: 100, en: "Thinking in Systems", cn: "Á≥ªÁªü‰πãÁæé", author: "Donella Meadows" }
        ];

        let currentView = 'grid';
        let currentPage = 1;
        let pageSize = Infinity;
        let searchTerm = '';
        let filterType = 'all';
        let sortField = 'rank';
        let sortDirection = 'asc';
        let readState = JSON.parse(localStorage.getItem('bookReadState')) || {};

        const elements = {
            gridView: document.getElementById('gridView'),
            listView: document.getElementById('listView'),
            tableBody: document.getElementById('tableBody'),
            pagination: document.getElementById('pagination'),
            searchInput: document.getElementById('searchInput'),
            filterSelect: document.getElementById('filterSelect'),
            progressText: document.getElementById('progress-text'),
            progressFill: document.getElementById('progress-fill'),
            emptyState: document.getElementById('emptyState'),
            viewButtons: document.querySelectorAll('.view-btn'),
            sortHeaders: document.querySelectorAll('[data-sort]')
        };

        function init() {
            setupEventListeners();
            updateProgress();
            renderCurrentView();
        }

        function setupEventListeners() {
            elements.viewButtons.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const targetBtn = e.target.closest('.view-btn');
                    if(targetBtn) {
                        const view = targetBtn.dataset.view;
                        switchView(view);
                    }
                });
            });

            elements.searchInput.addEventListener('input', debounce((e) => {
                searchTerm = e.target.value.toLowerCase();
                currentPage = 1;
                renderCurrentView();
            }, 300));

            elements.filterSelect.addEventListener('change', (e) => {
                filterType = e.target.value;
                currentPage = 1;
                renderCurrentView();
            });

            elements.sortHeaders.forEach(header => {
                header.addEventListener('click', () => {
                    const field = header.dataset.sort;
                    if (sortField === field) {
                        sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
                    } else {
                        sortField = field;
                        sortDirection = 'asc';
                    }
                    renderCurrentView();
                });
            });
        }

        function switchView(view) {
            currentView = view;
            elements.viewButtons.forEach(btn => {
                btn.classList.toggle('active', btn.dataset.view === view);
            });
            renderCurrentView();
        }

        function getFilteredAndSortedBooks() {
            let filtered = [...books];
            
            if (searchTerm) {
                filtered = filtered.filter(b => 
                    b.en.toLowerCase().includes(searchTerm) || 
                    b.cn.toLowerCase().includes(searchTerm) || 
                    b.author.toLowerCase().includes(searchTerm)
                );
            }
            
            if (filterType === 'read') filtered = filtered.filter(b => readState[b.rank]);
            if (filterType === 'unread') filtered = filtered.filter(b => !readState[b.rank]);

            filtered.sort((a, b) => {
                let valA = sortField === 'rank' ? a.rank : (sortField === 'title' ? a.en : a.author).toLowerCase();
                let valB = sortField === 'rank' ? b.rank : (sortField === 'title' ? b.en : b.author).toLowerCase();
                return sortDirection === 'asc' ? (valA < valB ? -1 : 1) : (valA > valB ? -1 : 1);
            });
            
            return filtered;
        }

        function renderCurrentView() {
            const allBooks = getFilteredAndSortedBooks();
            const start = pageSize === Infinity ? 0 : (currentPage - 1) * pageSize;
            const pagedBooks = pageSize === Infinity ? allBooks : allBooks.slice(start, start + pageSize);
            
            if (allBooks.length === 0) {
                elements.emptyState.classList.remove('hidden');
                elements.gridView.classList.add('hidden');
                elements.listView.classList.add('hidden');
                elements.pagination.innerHTML = '';
                return;
            }
            
            elements.emptyState.classList.add('hidden');
            
            if (currentView === 'grid') {
                elements.gridView.classList.remove('hidden');
                elements.listView.classList.add('hidden');
                
                elements.gridView.innerHTML = pagedBooks.map(b => `
                    <div class="book-card ${readState[b.rank] ? 'is-read' : ''}" onclick="window.location.href='BookNotes.html?id=${b.rank}'">
                        ${hasNotes(b.rank) ? '<div class="note-badge" title="Has notes"></div>' : ''}
                        <div class="card-rank">${b.rank}</div>
                        <div class="card-content">
                            <div class="title-en">${b.en}</div>
                            <div class="title-cn">${b.cn}</div>
                            <div class="author">${b.author}</div>
                        </div>
                        <div class="card-actions">
                            <span class="status-label">${readState[b.rank] ? 'Completed' : 'To Read'}</span>
                            <button class="check-btn" onclick="event.stopPropagation(); toggleBookStatus(${b.rank})" title="Toggle Read Status">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><polyline points="20 6 9 17 4 12"></polyline></svg>
                            </button>
                        </div>
                    </div>
                `).join('');
            } else {
                elements.gridView.classList.add('hidden');
                elements.listView.classList.remove('hidden');
                
                elements.tableBody.innerHTML = pagedBooks.map(b => `
                    <tr class="${readState[b.rank] ? 'is-read' : ''}" onclick="window.location.href='BookNotes.html?id=${b.rank}'">
                        <td class="table-rank">#${b.rank}</td>
                        <td>
                            <div class="table-title">${b.en}${hasNotes(b.rank) ? '<span class="table-note-badge" title="Has notes"></span>' : ''}</div>
                            <div class="table-meta">${b.cn}</div>
                        </td>
                        <td style="color:var(--text-secondary); font-size:0.85rem">${b.author}</td>
                        <td class="table-check-cell" style="text-align:right">
                            <button class="check-btn" style="margin-left:auto" onclick="event.stopPropagation(); toggleBookStatus(${b.rank})" title="Toggle Read Status">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><polyline points="20 6 9 17 4 12"></polyline></svg>
                            </button>
                        </td>
                    </tr>
                `).join('');
            }
            
            renderPagination(allBooks.length);
        }

        function renderPagination(total) {
            if (pageSize === Infinity) {
                elements.pagination.innerHTML = '';
                return;
            }
            
            const pages = Math.ceil(total / pageSize);
            let html = '';
            
            html += `<button class="page-btn" ${currentPage === 1 ? 'disabled' : ''} onclick="changePage(${currentPage - 1})">‚Äπ</button>`;
            
            let min = Math.max(1, currentPage - 2);
            let max = Math.min(pages, min + 4);
            if (max - min < 4) min = Math.max(1, max - 4);

            for (let i = min; i <= max; i++) {
                html += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
            }
            
            html += `<button class="page-btn" ${currentPage === pages ? 'disabled' : ''} onclick="changePage(${currentPage + 1})">‚Ä∫</button>`;
            elements.pagination.innerHTML = html;
        }

        function toggleBookStatus(rank) {
            readState[rank] = !readState[rank];
            localStorage.setItem('bookReadState', JSON.stringify(readState));
            updateProgress();
            renderCurrentView();
        }

        function updateProgress() {
            const count = Object.values(readState).filter(Boolean).length;
            elements.progressText.innerText = `${count} / ${books.length}`;
            elements.progressFill.style.width = `${(count / books.length) * 100}%`;
        }

        function changePage(p) {
            currentPage = p;
            renderCurrentView();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function debounce(func, wait) {
            let timeout;
            return (...args) => {
                clearTimeout(timeout);
                timeout = setTimeout(() => func(...args), wait);
            };
        }

        function hasNotes(rank) {
            try {
                const storageKey = `book_notes_${rank}`;
                const notes = JSON.parse(localStorage.getItem(storageKey)) || [];
                return notes.length > 0;
            } catch (e) {
                return false;
            }
        }

        document.addEventListener('DOMContentLoaded', init);
        window.changePage = changePage;
        window.toggleBookStatus = toggleBookStatus;
    </script>
</body>
</html>